<html>
    <title>Chat Test</title>

    <style>
        #header{
            text-align: center;
        }
        
        #chat-elements{
            float: left;
        }
        #details{
            float: right;
        }

        #chat{
            height: 300px;
            width: 400px;
            border: groove;
            overflow-y: scroll;
        }

        #send-message{
            padding: 10px 10px 0px .4em;
        }

    </style>
    <head>
        <script src ="https://code.jquery.com/jquery-latest.min.js"></script>
        <script src ="/socket.io/socket.io.js"></script>
	
        <script>

            //jQuery(function($){

                var socket = io.connect();

                var $messageForm = $('#send-message');
                var $messageBox = $('#message');
                var $chat = $('#chat');

                $messageForm.submit(function(e){

                    e.preventDefault();
                    socket.emit('send-message', $messageBox.val());
                    $messageBox.val('');

                });

                socket.on('new message', function(data){
                    var chat = $("#chat");
                    chat.append(data + "<br/>");
                    var h = chat[0].scrollHeight;
                    chat.scrollTop(h);
                });
            //});

        </script>
        
        <script type="text/javascript">
            var currentRoom = "";
            
            function init() {
                console.log("Initializing DOM-dependent JS.");
                $("#set-room").click(setRoom);
            }
            
            function setRoom() {
                var roomName = $("#room").val();
                console.log("Attempting to change room to '" + roomName + "'")
                socket.emit("room-change", roomName);
            }
            
            $(document).ready(init);
        </script>
    </head>
<body>
    <h1 id="header">Welcome to Chat584!</h1>
    <div id="chat-elements">
        <div id = "chat">Welcome to Chat584!  Select a room to join.<br></div><br>
        <form id = "send-message">
            <input size = "35" id = "message"><br>
            <input type = "submit">
        </form>
    </div>

    <div id="details">
        Username: <input id="user" size="16"><br>
        Room: <input id="room" size="16"><br>
        <button id="set-room">Join room</button>
    </div>

</body></html>
